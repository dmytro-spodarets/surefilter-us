# Admin Action Logging - Quick Guide

## üìã –ß—Ç–æ —ç—Ç–æ?
–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏.

## ‚úÖ –ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è (v0.0.94):

### –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:
1. **Pages** (–°—Ç—Ä–∞–Ω–∏—Ü—ã)
   - ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   - ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
   - ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

2. **Settings** (–ù–∞—Å—Ç—Ä–æ–π–∫–∏)
   - ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–∞–π—Ç–∞

3. **Users** (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
   - ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∞
   - ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∞
   - ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞

4. **Products** (–ü—Ä–æ–¥—É–∫—Ç—ã)
   - ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞
   - ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞
   - ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–¥—É–∫—Ç–∞

## üìä –ß—Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ –ª–æ–≥:

–ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç:
- **–ö—Ç–æ**: ID –∏ email –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- **–ö–æ–≥–¥–∞**: –¢–æ—á–Ω–æ–µ –≤—Ä–µ–º—è –¥–µ–π—Å—Ç–≤–∏—è
- **–ß—Ç–æ**: CREATE / UPDATE / DELETE
- **–ì–¥–µ**: –¢–∏–ø —Å—É—â–Ω–æ—Å—Ç–∏ (Page, Settings, User, Product)
- **–î–µ—Ç–∞–ª–∏**: 
  - ID —Å—É—â–Ω–æ—Å—Ç–∏
  - –ù–∞–∑–≤–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–∏
  - –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ –ø–æ–ª—è (–¥–ª—è UPDATE)
  - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **–û—Ç–∫—É–¥–∞**:
  - IP –∞–¥—Ä–µ—Å
  - User Agent (–±—Ä–∞—É–∑–µ—Ä)

## üìç –ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏:

1. –ó–∞–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É
2. **Settings** ‚Üí **Activity Logs**
3. –ò–ª–∏ –Ω–∞–ø—Ä—è–º—É—é: `/admin/logs`

## üé® –¶–≤–µ—Ç–æ–≤–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞:

- üü¢ **CREATE** - –∑–µ–ª—ë–Ω—ã–π (—Å–æ–∑–¥–∞–Ω–∏–µ)
- üîµ **UPDATE** - —Å–∏–Ω–∏–π (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
- üî¥ **DELETE** - –∫—Ä–∞—Å–Ω—ã–π (—É–¥–∞–ª–µ–Ω–∏–µ)
- üü£ **LOGIN** - —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π (–≤—Ö–æ–¥)

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:
- –¢–∞–±–ª–∏—Ü–∞: `AdminLog`
- Enum: `AdminAction` (CREATE, UPDATE, DELETE, LOGIN, LOGOUT)

### API:
- `GET /api/admin/logs` - –ø–æ–ª—É—á–∏—Ç—å –ª–æ–≥–∏ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏

### –£—Ç–∏–ª–∏—Ç–∞:
- `/lib/admin-logger.ts` - —Ñ—É–Ω–∫—Ü–∏—è `logAdminAction()`

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ API routes:
- `/api/admin/pages/route.ts` - CREATE
- `/api/admin/pages/[...slug]/route.ts` - UPDATE, DELETE
- `/api/admin/site-settings/route.ts` - UPDATE
- `/api/admin/users/route.ts` - CREATE
- `/api/admin/users/[id]/route.ts` - UPDATE, DELETE
- `/api/admin/products/route.ts` - CREATE
- `/api/admin/products/[id]/route.ts` - UPDATE, DELETE

## üîÑ –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–π —Å—É—â–Ω–æ—Å—Ç–∏:

### 1. –ò–º–ø–æ—Ä—Ç—ã:
```typescript
import { getServerSession } from 'next-auth';
import { authOptions } from '@/lib/auth';
import { logAdminAction, getRequestMetadata } from '@/lib/admin-logger';
```

### 2. –ü–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ CREATE/UPDATE/DELETE:
```typescript
const session = await getServerSession(authOptions);
if (session) {
  const metadata = getRequestMetadata(request);
  await logAdminAction({
    userId: (session.user as any).id,
    action: 'CREATE', // –∏–ª–∏ 'UPDATE', 'DELETE'
    entityType: 'YourEntity', // –Ω–∞–ø—Ä–∏–º–µ—Ä 'News', 'Resource'
    entityId: entity.id,
    entityName: entity.title || entity.name,
    details: { /* –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è */ },
    ...metadata,
  });
}
```

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ª–æ–≥–æ–≤:
```typescript
// –ü–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
GET /api/admin/logs?userId=user-id

// –ü–æ –¥–µ–π—Å—Ç–≤–∏—é
GET /api/admin/logs?action=DELETE

// –ü–æ —Ç–∏–ø—É —Å—É—â–Ω–æ—Å—Ç–∏
GET /api/admin/logs?entityType=Page

// –ü–∞–≥–∏–Ω–∞—Ü–∏—è
GET /api/admin/logs?page=2&limit=50
```

## üöÄ –ß—Ç–æ –¥–∞–ª—å—à–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è:
- News (CREATE/UPDATE/DELETE)
- Resources (CREATE/UPDATE/DELETE)
- Form Submissions
- Media Files
- Categories
- –ò –¥—Ä—É–≥–∏—Ö —Å—É—â–Ω–æ—Å—Ç–µ–π –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

–®–∞–±–ª–æ–Ω—ã –≥–æ—Ç–æ–≤—ã –≤ `LOGGING_IMPLEMENTATION.md` –∏ `ADD_LOGGING_SCRIPT.md`

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. **–ê—É–¥–∏—Ç**: –ö—Ç–æ, —á—Ç–æ –∏ –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª
3. **–û—Ç–ª–∞–¥–∫–∞**: –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –ø—Ä–∏—á–∏–Ω—É –ø—Ä–æ–±–ª–µ–º
4. **Compliance**: –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
5. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**: –í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –≤–∏–¥–Ω—ã –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã

---

**–í–µ—Ä—Å–∏—è**: v0.0.94  
**–î–∞—Ç–∞**: 2025-12-29  
**–°—Ç–∞—Ç—É—Å**: Production Ready ‚úÖ
