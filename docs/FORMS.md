# Universal Forms System

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —Ñ–æ—Ä–º –¥–ª—è Sure Filter US.

---

## üìã –û–±–∑–æ—Ä

Universal Forms System - —ç—Ç–æ –≥–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–æ—Ä–º–∞–º–∏ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π:
- 7 —Ç–∏–ø–æ–≤ –ø–æ–ª–µ–π
- Webhook –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- Gated content (—Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É)
- CSV —ç–∫—Å–ø–æ—Ä—Ç –∑–∞—è–≤–æ–∫
- –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –≤ CMS

---

## üéØ –¢–∏–ø—ã —Ñ–æ—Ä–º

### 1. CONTACT - –ö–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ —Ñ–æ—Ä–º—ã
–î–ª—è –æ–±—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏, –ø–æ–¥–¥–µ—Ä–∂–∫–∏.

### 2. DOWNLOAD - Gated Content
–î–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ (–∫–∞—Ç–∞–ª–æ–≥–∏, —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏, white papers).

---

## üîß –¢–∏–ø—ã –ø–æ–ª–µ–π

| –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | –í–∞–ª–∏–¥–∞—Ü–∏—è |
|-----|----------|-----------|
| `text` | –¢–µ–∫—Å—Ç–æ–≤–æ–µ –ø–æ–ª–µ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
| `email` | Email –∞–¥—Ä–µ—Å | Email —Ñ–æ—Ä–º–∞—Ç |
| `phone` | –¢–µ–ª–µ—Ñ–æ–Ω | Phone —Ñ–æ—Ä–º–∞—Ç |
| `textarea` | –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ç–µ–∫—Å—Ç | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
| `select` | –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
| `checkbox` | –ß–µ–∫–±–æ–∫—Å | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
| `radio` | –†–∞–¥–∏–æ –∫–Ω–æ–ø–∫–∏ | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å |

---

## üé® –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–æ—Ä–º—ã

### 1. –ß–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ **Forms ‚Üí New Form**
2. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é:
   - **Name**: –ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º—ã
   - **Type**: CONTACT –∏–ª–∏ DOWNLOAD
   - **Description**: –û–ø–∏—Å–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è:
   - –ù–∞–∂–∞—Ç—å **Add Field**
   - –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø –ø–æ–ª—è
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
   - Drag & drop –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ—Ä—è–¥–∫–∞
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
   - URL –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
   - Retry –ª–æ–≥–∏–∫–∞ —Å exponential backoff
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–æ—Ä–º—É

### 2. –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ

```typescript
const form = await prisma.form.create({
  data: {
    name: 'Contact Us',
    type: 'CONTACT',
    description: 'General inquiry form',
    fields: {
      create: [
        {
          type: 'text',
          label: 'Full Name',
          name: 'fullName',
          required: true,
          position: 0,
        },
        {
          type: 'email',
          label: 'Email Address',
          name: 'email',
          required: true,
          position: 1,
        },
        {
          type: 'textarea',
          label: 'Message',
          name: 'message',
          required: true,
          position: 2,
        },
      ],
    },
  },
});
```

---

## üìù –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –≤ CMS

### –°–µ–∫—Ü–∏—è form_embed

```typescript
// –í CMS –¥–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é —Ç–∏–ø–∞ form_embed
{
  type: 'form_embed',
  data: {
    formId: 'form_id_here',
    title: 'Contact Us',
    description: 'We\'d love to hear from you',
  }
}
```

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç DynamicForm

```tsx
import DynamicForm from '@/components/forms/DynamicForm';

<DynamicForm
  formId="form_id_here"
  onSuccess={(data) => {
    console.log('Form submitted:', data);
  }}
/>
```

---

## üîó Webhook Integration

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

```typescript
const form = await prisma.form.update({
  where: { id: formId },
  data: {
    webhookUrl: 'https://your-api.com/webhook',
    webhookEnabled: true,
  },
});
```

### Payload —Ñ–æ—Ä–º–∞—Ç

```json
{
  "formId": "cm123abc",
  "formName": "Contact Us",
  "submissionId": "cm456def",
  "submittedAt": "2025-12-20T13:00:00Z",
  "data": {
    "fullName": "John Doe",
    "email": "john@example.com",
    "message": "Hello!"
  }
}
```

### Retry –ª–æ–≥–∏–∫–∞

- **–ü–æ–ø—ã—Ç–∫–∏**: 3 retry —Å exponential backoff
- **–ò–Ω—Ç–µ—Ä–≤–∞–ª—ã**: 1s, 2s, 4s
- **Timeout**: 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—Ä–æ—Å
- **–°—Ç–∞—Ç—É—Å—ã**: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤ –∞–¥–º–∏–Ω–∫–µ

---

## üìä –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞—è–≤–∫–∞–º–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞—è–≤–æ–∫

1. **Forms ‚Üí [Form Name] ‚Üí Submissions**
2. –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞—è–≤–æ–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π
3. –î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∫–∞–∂–¥–æ–π –∑–∞—è–≤–∫–∏

### CSV Export

```typescript
// –ö–Ω–æ–ø–∫–∞ Export CSV –≤ –∞–¥–º–∏–Ω–∫–µ
// –§–æ—Ä–º–∞—Ç: –≤—Å–µ –ø–æ–ª—è + timestamp + status
```

### Webhook Retry

```typescript
// –í –∞–¥–º–∏–Ω–∫–µ –¥–ª—è –∫–∞–∂–¥–æ–π –∑–∞—è–≤–∫–∏:
// - –°—Ç–∞—Ç—É—Å webhook (success/failed/pending)
// - –ö–Ω–æ–ø–∫–∞ Manual Retry
// - –ò—Å—Ç–æ—Ä–∏—è –ø–æ–ø—ã—Ç–æ–∫
```

---

## üéØ Gated Content

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ—Å—É—Ä—Å–∞

```typescript
const resource = await prisma.resource.create({
  data: {
    title: 'Heavy Duty Catalog 2025',
    type: 'CATALOG',
    categoryId: 'category_id',
    isGated: true,
    formId: 'download_form_id',
    fileUrl: '/files/catalog-2025.pdf',
  },
});
```

### –ü—Ä–æ—Ü–µ—Å—Å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "Download"
2. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ñ–æ—Ä–º–∞ (–µ—Å–ª–∏ `isGated: true`)
3. –ü–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º—ã:
   - –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î
   - Webhook –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
   - –§–∞–π–ª —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
4. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–∞–π–ª

---

## üîí –í–∞–ª–∏–¥–∞—Ü–∏—è

### –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

```typescript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–∞ –ø–æ–ª—è
{
  type: 'email',
  required: true,
  // –í–∞–ª–∏–¥–∞—Ü–∏—è: email —Ñ–æ—Ä–º–∞—Ç + –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
}

{
  type: 'phone',
  required: true,
  // –í–∞–ª–∏–¥–∞—Ü–∏—è: phone —Ñ–æ—Ä–º–∞—Ç + –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
}
```

### –°–µ—Ä–≤–µ—Ä–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è

```typescript
// API endpoint: POST /api/forms/[formId]/submit
// Zod schema –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π
// –ü—Ä–æ–≤–µ—Ä–∫–∞ required –ø–æ–ª–µ–π
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤ (email, phone)
```

---

## üì° API Endpoints

### Forms Management

```
GET    /api/admin/forms              - –°–ø–∏—Å–æ–∫ —Ñ–æ—Ä–º
POST   /api/admin/forms              - –°–æ–∑–¥–∞—Ç—å —Ñ–æ—Ä–º—É
GET    /api/admin/forms/[id]         - –ü–æ–ª—É—á–∏—Ç—å —Ñ–æ—Ä–º—É
PUT    /api/admin/forms/[id]         - –û–±–Ω–æ–≤–∏—Ç—å —Ñ–æ—Ä–º—É
DELETE /api/admin/forms/[id]         - –£–¥–∞–ª–∏—Ç—å —Ñ–æ—Ä–º—É
```

### Submissions

```
GET    /api/admin/forms/[id]/submissions     - –°–ø–∏—Å–æ–∫ –∑–∞—è–≤–æ–∫
POST   /api/forms/[id]/submit                - –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É (public)
POST   /api/admin/forms/[id]/submissions/[submissionId]/retry - Retry webhook
GET    /api/admin/forms/[id]/submissions/export - Export CSV
```

---

## üé® –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### –°—Ç–∏–ª–∏ —Ñ–æ—Ä–º—ã

```tsx
// –í DynamicForm –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
<form className="space-y-6">
  <input className="w-full px-4 py-2 border rounded-lg" />
  <button className="bg-sure-blue-600 text-white px-6 py-2 rounded-lg">
    Submit
  </button>
</form>
```

### Success/Error —Å–æ–æ–±—â–µ–Ω–∏—è

```tsx
<DynamicForm
  formId="form_id"
  onSuccess={(data) => {
    toast.success('Thank you for your submission!');
  }}
  onError={(error) => {
    toast.error('Something went wrong. Please try again.');
  }}
/>
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç —Ñ–æ—Ä–º–∞

1. –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é —Ñ–æ—Ä–º—É –≤ –∞–¥–º–∏–Ω–∫–µ
2. –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ —Ç–∏–ø—ã –ø–æ–ª–µ–π
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook –Ω–∞ https://webhook.site
4. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞—è–≤–∫—É
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å:
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
   - Webhook payload
   - Retry –ª–æ–≥–∏–∫—É (–æ—Ç–∫–ª—é—á–∏—Ç—å webhook.site)
   - CSV export

### Webhook —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ webhook.site –∏–ª–∏ requestbin.com
# –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è payload –∏ retry –ª–æ–≥–∏–∫–∏
```

---

## üìö –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è —Ñ–æ—Ä–º–∞

```typescript
// –§–æ—Ä–º–∞ —Å –±–∞–∑–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏
{
  name: 'Contact Us',
  type: 'CONTACT',
  fields: [
    { type: 'text', label: 'Name', required: true },
    { type: 'email', label: 'Email', required: true },
    { type: 'phone', label: 'Phone', required: false },
    { type: 'select', label: 'Subject', options: ['Sales', 'Support', 'Other'] },
    { type: 'textarea', label: 'Message', required: true },
  ]
}
```

### Download —Ñ–æ—Ä–º–∞

```typescript
// –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞ –¥–ª—è gated content
{
  name: 'Catalog Download',
  type: 'DOWNLOAD',
  fields: [
    { type: 'text', label: 'Full Name', required: true },
    { type: 'email', label: 'Email', required: true },
    { type: 'text', label: 'Company', required: false },
  ]
}
```

---

## üîç Troubleshooting

### –§–æ—Ä–º–∞ –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–æ–ª–µ–π
2. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools Console
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Network tab –¥–ª—è API errors
4. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ formId –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

### Webhook –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Ñ–æ—Ä–º—ã
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ webhookEnabled: true
3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ –∞–¥–º–∏–Ω–∫–µ (submission details)
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Manual Retry –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### CSV export –ø—É—Å—Ç–æ–π

1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –µ—Å—Ç—å submissions
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ (admin only)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î

---

## üìñ –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- **CMS Integration**: `surefilter-ui/docs/SHARED_SECTIONS.md`
- **Resources System**: –°–º. —Ä–∞–∑–¥–µ–ª Resources –≤ STATUS.md
- **API Documentation**: –°–º. –∫–æ–¥ –≤ `src/app/api/forms/`
